import type { Day, Lang, SubjectKey, Translations } from "./types";

const I18N: Record<Lang, Translations> = {
  en: {
    appTitle: "Stream Planner",
    campusPlan: "Campus Plan",
    homerooms: "Homerooms",
    reconciliation: "Reconciliation",
    apply: "Seed Homerooms →",
    applyHint: "Seeds homeroom timetables from selected courses (and opens them on campus). You can tweak per homeroom after.",
    step0: "Step 0 — Demand Snapshot",
    step0Hint: "Review demand first, then choose levels in the action section below.",
    step0ActionTitle: "Which levels will you run for each subject?",
    step0Ready: "Step 0 complete. You explicitly set level policy for all leveled subjects.",
    step0NeedsDecision: "Explicit subject decisions:",
    step0NeedsTwoLevels: "Subjects with at least two running levels:",
    levelsSelected: "levels selected",
    run: "Run",
    sacrifice: "Sacrifice",
    noteExcludesDoneQ: "Qudrat demand excludes students who are done with Qudrat",
    step1: "Step 1 — Choose Course Bundles",
    step1Hint: "Pick a bundle (L1/L2/L3 taught by specific teachers) for each leveled subject.",
    step1Ready: "Step 1 complete. A bundle is selected for every leveled subject.",
    step1NeedsBundle: "Bundled subjects selected:",
    unlockStep1: "Finish Step 0 to reveal Step 1.",
    step2: "Step 2 — Grade-wide Courses",
    step2Hint: "Pick one slot for every offered subject. This step is required.",
    step2Ready: "Step 2 complete. All offered grade-wide subjects have a selected slot.",
    step2NeedsSelections: "Required offerings selected:",
    unlockStep2: "Finish Step 1 to reveal Step 2.",
    finishCampusFlowHint: "Finish all Campus Plan steps to enable Apply.",
    underConstructionBanner: "Under construction: finish your required Campus Plan steps first.",
    openLevels: "Open levels",
    empty: "Empty",
    pickCourse: "Pick a course",
    availableCourses: "Available Courses",
    replaceCourse: "Replace course",
    selectedCourse: "Selected course",
    filters: "Filters",
    all: "All",
    close: "Close",
    clear: "Clear",
    aligned: "Aligned",
    mustMoveOut: "Must Move Out",
    forcedStay: "Forced Stay",
    movingIn: "Moving In",
    assign: "Assign →",
    destination: "Assign destination",
    unresolved: "Unresolved",
    done: "Complete",
    slots: "slots",
    moves: "moves",
    noCourses: "No eligible courses for this day + slot.",
    reasonNoSupply: "No matching course running somewhere on campus for this slot",
    reasonDoneQudrat: "Done with Qudrat → self-study (no Tahsili option this slot)",
    language: "Language",
    english: "English",
    arabic: "العربية",
    break: "break",
    campusName: "DAB Campus",
    roomsLabel: "Rooms",
    studentsLabel: "Students",
    subject: "Subject",
    decision: "Decision",
    level: "Level",
    grade: "Grade",
    slot: "Slot",
    slotLabelWithValue: "Slot {slot}",
    bundleMeetings: "Bundle meetings",
    doneQShort: "done Q",
    stillQShort: "still Q",
    prototypePolicyG12: "Prototype policy: Grade 12 homerooms are Tahsili. Any Grade 12 student still on Qudrat must move out.",
    openCoursesFirstTitle: "Open courses first",
    openCoursesFirstBody: "Go to Campus Plan and click Apply so this campus has an opened course set.",
    scheduleComplete: "Schedule Complete",
    noUnresolvedMoves: "No Unresolved Moves",
    emptySlots: "empty slots.",
    allResolved: "All resolved.",
    roster: "Roster",
    from: "from",
    capacity: "Capacity",
    noValidDestinations: "No valid destinations.",
    qudratLabel: "Qudrat",
    tahsiliLabel: "Tahsili",
    notDone: "not done",
    subjectKammi: "Qudrat Kammi",
    subjectLafthi: "Qudrat Lafthi",
    subjectEsl: "ESL (IELTS)",
    subjectMinistry: "Ministry English",
    subjectFuture: "Future Skills",
    subjectTMath: "Tahsili Math",
    subjectTChem: "Tahsili Chem",
    subjectTBio: "Tahsili Bio",
    subjectTPhysics: "Tahsili Physics",
    cycleCurrentTitle: "Spring 26 Semester",
    cycleCurrentSub: "Current cycle",
    cycleCurrentStatus: "Current",
    cycleStepProgress: "Step {step} of 3",
    cycleStepGuidedSetup: "Guided setup. Editing earlier steps clears later progress.",
    cycleStep0CompleteTitle: "Step 0 complete",
    cycleStep0CompleteCopy: "{ready}/{total} subjects have running levels.",
    cycleEditStep0: "Edit Step 0",
    cycleStep1CompleteTitle: "Step 1 complete",
    cycleStep1CompleteCopy: "{selected}/{total} bundle maps selected.",
    cycleEditStep1: "Edit Step 1",
    v6Step0Title: "Step 0 — Qudrat status and level demand",
    v6DoneQExcludedNote: "{count} students are not included in Kammi/Lafthi counts below because they are done with Qudrat.",
    step0LevelsRunningSummary: "{running}/3 levels running · {moved} force-moved",
    activate: "Activate",
    split: "Split",
    forceMove: "Force move",
    moveToL1: "Move to L1",
    moveToL3: "Move to L3",
    studentsCount: "students",
    studentsToMove: "Students to move",
    remainInLevel: "{count} remain in {level}",
    readyForStep1: "Ready for Step 1.",
    step0ProgressLine: "{ready}/{total} subjects have at least one running level.",
    continueToStep1: "Continue to Step 1",
    v6Step1Title: "Step 1 — Bundle and room map",
    roomHeader: "Room",
    hostHeader: "Host",
    projectedRosterHeader: "Projected roster",
    tahsiliAuto: "Tahsili (auto)",
    step1Summary: "{stay} stay · {move} move · {forced} forced stays",
    maxRosterSummary: "max roster {count} students",
    chooseBundleRoomMap: "Choose a bundle to generate a room map.",
    stepIssueSelectBundle: "Select a bundle.",
    stepIssueRoomMapMissing: "Room map is missing.",
    stepIssueMissingLevelRoom: "Missing room allocation for {level}.",
    readyForStep2: "Ready for Step 2.",
    step1ProgressLine: "Bundles selected: {selected}/{total}. Allocate all running levels.",
    continueToStep2: "Continue to Step 2",
    confirmBackToStep0: "Go back to Step 0? This clears Step 1 and Step 2 progress.",
    confirmBackToStep1: "Go back to Step 1? This clears Step 2 progress.",
    leveledCourseLabel: "leveled course",
    blockedByOnSlot: "Blocked by {label} on {day} · {slotLabel} {slot}.",
    blockedByLabel: "Blocked by {label}.",
    blockedDueToConflict: "Blocked due to a slot conflict.",
    whyOptionDisabled: "Why this option is disabled",
    readyToApply: "Ready to apply.",
    resolveConflictsBeforeApply: "Resolve schedule conflicts before applying.",
    step2SelectionsCompleted: "{selected}/{total} selections completed.",
    conflictsWithLeveledPlan: "conflicts with leveled plan",
    conflictsWithGradeWide: "conflicts with another grade-wide selection",
    step2CompleteTitle: "Step 2 complete",
    step2CompleteCopy: "All required grade-wide selections are valid.",
    editStep2: "Edit Step 2",
    cycleReadyTitle: "Ready to apply",
    cycleReadyCopy: "This cycle setup is complete. Apply to seed homeroom schedules.",
    cycleUpcomingTitle: "Fall 26 Semester",
    cycleUpcomingSub: "Upcoming cycle",
    cycleUpcomingStatus: "Upcoming",
    cycleLockedCopy: "This cycle is not open yet. HQ will open it when scheduling starts.",
    roomFlagsTitle: "Room flags",
    roomFlagsEmpty: "No active issues in this room.",
    roomFlagForcedStay: "{count} students forced to stay in {course}{reason}.",
    roomFlagRosterOverflow: "{course} expected roster is {count} students.",
    step2OverwriteConflicts: "Step 2 overwrite conflicts",
    manualReconciliationRequired: "Manual reconciliation required",
    unknown: "Unknown",
    moveAction: "Move",
    step2IssueLine: "{gradeLabel} {grade} · {subject} · {day} · {slotLabel} {slot} · {reason}",
    roomProjectedStudents: "{count} students",
  },
  ar: {
    appTitle: "مخطط المسارات",
    campusPlan: "خطة المدرسة",
    homerooms: "الفصول",
    reconciliation: "تسوية الحركة",
    apply: "تعبئة الفصول →",
    applyHint: "يعبّي جداول الفصول بناءً على الدورات المختارة (ويفتحها على مستوى المدرسة). بعدها تقدر تعدّل لكل فصل.",
    step0: "الخطوة 0 — صورة الطلب",
    step0Hint: "راجع الطلب أولاً، ثم اختر المستويات في قسم الإجراء أدناه.",
    step0ActionTitle: "ما المستويات التي ستشغّلها لكل مادة؟",
    step0Ready: "اكتملت الخطوة 0. تم تحديد سياسة المستويات لكل المواد متعددة المستويات.",
    step0NeedsDecision: "القرارات الصريحة للمواد:",
    step0NeedsTwoLevels: "مواد تشغّل مستويين على الأقل:",
    levelsSelected: "مستويات مختارة",
    run: "تشغيل",
    sacrifice: "إيقاف",
    noteExcludesDoneQ: "طلب القدرات لا يشمل الطلاب المنتهين من القدرات",
    step1: "الخطوة 1 — اختيار باقات الدورات",
    step1Hint: "اختر باقة (L1/L2/L3 بمدرسين محددين) لكل مادة متعددة المستويات.",
    step1Ready: "اكتملت الخطوة 1. تم اختيار باقة لكل مادة متعددة المستويات.",
    step1NeedsBundle: "المواد التي تم اختيار باقتها:",
    unlockStep1: "أكمل الخطوة 0 لعرض الخطوة 1.",
    step2: "الخطوة 2 — دورات الصف بالكامل",
    step2Hint: "اختر حصة واحدة لكل مادة متاحة. هذه الخطوة إلزامية.",
    step2Ready: "اكتملت الخطوة 2. تم اختيار حصة لكل المواد المتاحة على مستوى الصف.",
    step2NeedsSelections: "المواد المطلوبة التي تم اختيارها:",
    unlockStep2: "أكمل الخطوة 1 لعرض الخطوة 2.",
    finishCampusFlowHint: "أكمل جميع خطوات خطة المدرسة لتفعيل زر التعبئة.",
    underConstructionBanner: "قيد الإنشاء: أكمل خطوات خطة المدرسة المطلوبة أولاً.",
    openLevels: "فتح المستويات",
    empty: "فارغ",
    pickCourse: "اختر دورة",
    availableCourses: "الدورات المتاحة",
    replaceCourse: "استبدال الدورة",
    selectedCourse: "الدورة المختارة",
    filters: "فلاتر",
    all: "الكل",
    close: "إغلاق",
    clear: "مسح",
    aligned: "متوافق",
    mustMoveOut: "لازم يطلع",
    forcedStay: "يبقى (بدون بديل)",
    movingIn: "داخل",
    assign: "تعيين →",
    destination: "تعيين الوجهة",
    unresolved: "غير مُعيّن",
    done: "مكتمل",
    slots: "حصص",
    moves: "حركات",
    noCourses: "لا توجد دورات مناسبة لهذا اليوم والوقت.",
    reasonNoSupply: "لا توجد دورة مناسبة شغّالة في المدرسة (في أي فصل) لهذا الوقت",
    reasonDoneQudrat: "منتهي من القدرات → دراسة ذاتية (لا يوجد تحصيلي هنا)",
    language: "اللغة",
    english: "الإنجليزية",
    arabic: "العربية",
    break: "استراحة",
    campusName: "حرم DAB",
    roomsLabel: "فصول",
    studentsLabel: "طلاب",
    subject: "المادة",
    decision: "القرار",
    level: "المستوى",
    grade: "الصف",
    slot: "الحصة",
    slotLabelWithValue: "الحصة {slot}",
    bundleMeetings: "اجتماعات الباقة",
    doneQShort: "منتهي قدرات",
    stillQShort: "مستمر قدرات",
    prototypePolicyG12: "سياسة النموذج: فصول الصف 12 تحصيلي. أي طالب صف 12 ما خلص القدرات لازم يطلع.",
    openCoursesFirstTitle: "افتح الدورات أولاً",
    openCoursesFirstBody: "اذهب إلى خطة المدرسة ثم اضغط تعبئة الفصول حتى يتم فتح الدورات على مستوى المدرسة.",
    scheduleComplete: "اكتمل الجدول",
    noUnresolvedMoves: "لا توجد حركات غير مُعيّنة",
    emptySlots: "حصص فارغة.",
    allResolved: "تمت التسوية بالكامل.",
    roster: "قائمة الطلاب",
    from: "من",
    capacity: "السعة",
    noValidDestinations: "لا توجد وجهات صالحة.",
    qudratLabel: "القدرات",
    tahsiliLabel: "التحصيلي",
    notDone: "غير منتهٍ",
    subjectKammi: "قدرات كمي",
    subjectLafthi: "قدرات لفظي",
    subjectEsl: "ESL (IELTS)",
    subjectMinistry: "الإنجليزي الوزاري",
    subjectFuture: "مهارات المستقبل",
    subjectTMath: "تحصيلي رياضيات",
    subjectTChem: "تحصيلي كيمياء",
    subjectTBio: "تحصيلي أحياء",
    subjectTPhysics: "تحصيلي فيزياء",
    cycleCurrentTitle: "فصل ربيع 26",
    cycleCurrentSub: "الدورة الحالية",
    cycleCurrentStatus: "حالية",
    cycleStepProgress: "الخطوة {step} من 3",
    cycleStepGuidedSetup: "إعداد موجّه. تعديل الخطوات السابقة يمسح تقدم الخطوات اللاحقة.",
    cycleStep0CompleteTitle: "اكتملت الخطوة 0",
    cycleStep0CompleteCopy: "{ready}/{total} مواد لديها مستويات قيد التشغيل.",
    cycleEditStep0: "تعديل الخطوة 0",
    cycleStep1CompleteTitle: "اكتملت الخطوة 1",
    cycleStep1CompleteCopy: "{selected}/{total} خرائط باقات تم اختيارها.",
    cycleEditStep1: "تعديل الخطوة 1",
    v6Step0Title: "الخطوة 0 — حالة القدرات وطلب المستويات",
    v6DoneQExcludedNote: "{count} طالب غير مشمولين في أعداد كمي/لفظي أدناه لأنهم أنهوا القدرات.",
    step0LevelsRunningSummary: "{running}/3 مستويات قيد التشغيل · {moved} تم نقلهم إجباريًا",
    activate: "تفعيل",
    split: "تقسيم",
    forceMove: "نقل إجباري",
    moveToL1: "نقل إلى L1",
    moveToL3: "نقل إلى L3",
    studentsCount: "طالب",
    studentsToMove: "عدد الطلاب المنقولين",
    remainInLevel: "{count} باقون في {level}",
    readyForStep1: "جاهز للخطوة 1.",
    step0ProgressLine: "{ready}/{total} مواد لديها مستوى واحد قيد التشغيل على الأقل.",
    continueToStep1: "الانتقال إلى الخطوة 1",
    v6Step1Title: "الخطوة 1 — الباقة وخريطة الفصول",
    roomHeader: "الفصل",
    hostHeader: "المستضيف",
    projectedRosterHeader: "العدد المتوقع",
    tahsiliAuto: "تحصيلي (تلقائي)",
    step1Summary: "{stay} ثابتون · {move} منتقلون · {forced} بقوا قسرًا",
    maxRosterSummary: "أعلى عدد متوقع {count} طالب",
    chooseBundleRoomMap: "اختر باقة لتوليد خريطة الفصول.",
    stepIssueSelectBundle: "اختر باقة.",
    stepIssueRoomMapMissing: "خريطة الفصول غير متوفرة.",
    stepIssueMissingLevelRoom: "لا يوجد توزيع فصل للمستوى {level}.",
    readyForStep2: "جاهز للخطوة 2.",
    step1ProgressLine: "الباقات المختارة: {selected}/{total}. وزّع كل المستويات العاملة.",
    continueToStep2: "الانتقال إلى الخطوة 2",
    confirmBackToStep0: "الرجوع إلى الخطوة 0؟ سيؤدي ذلك إلى مسح تقدم الخطوتين 1 و2.",
    confirmBackToStep1: "الرجوع إلى الخطوة 1؟ سيؤدي ذلك إلى مسح تقدم الخطوة 2.",
    leveledCourseLabel: "مادة متعددة المستويات",
    blockedByOnSlot: "محجوب بسبب {label} في {day} · {slotLabel} {slot}.",
    blockedByLabel: "محجوب بسبب {label}.",
    blockedDueToConflict: "محجوب بسبب تعارض في الحصة.",
    whyOptionDisabled: "سبب تعطيل هذا الخيار",
    readyToApply: "جاهز للتطبيق.",
    resolveConflictsBeforeApply: "حل تعارضات الجدول قبل التطبيق.",
    step2SelectionsCompleted: "{selected}/{total} تم إكمالها.",
    conflictsWithLeveledPlan: "يتعارض مع خطة المواد متعددة المستويات",
    conflictsWithGradeWide: "يتعارض مع اختيار آخر على مستوى الصف",
    step2CompleteTitle: "اكتملت الخطوة 2",
    step2CompleteCopy: "جميع اختيارات مواد الصف المطلوبة صالحة.",
    editStep2: "تعديل الخطوة 2",
    cycleReadyTitle: "جاهز للتطبيق",
    cycleReadyCopy: "إعداد هذه الدورة مكتمل. طبّق لتعبئة جداول الفصول.",
    cycleUpcomingTitle: "فصل خريف 26",
    cycleUpcomingSub: "دورة قادمة",
    cycleUpcomingStatus: "قادمة",
    cycleLockedCopy: "هذه الدورة غير مفتوحة بعد. ستقوم الإدارة بفتحها عند بدء الجدولة.",
    roomFlagsTitle: "تنبيهات الفصل",
    roomFlagsEmpty: "لا توجد مشاكل نشطة في هذا الفصل.",
    roomFlagForcedStay: "{count} طالب مضطرون للبقاء في {course}{reason}.",
    roomFlagRosterOverflow: "العدد المتوقع في {course} هو {count} طالب.",
    step2OverwriteConflicts: "تعارضات استبدال الخطوة 2",
    manualReconciliationRequired: "تسوية يدوية مطلوبة",
    unknown: "غير معروف",
    moveAction: "نقل",
    step2IssueLine: "{gradeLabel} {grade} · {subject} · {day} · {slotLabel} {slot} · {reason}",
    roomProjectedStudents: "{count} طالب",
  },
};

const SUBJECT_KEY_TO_TRANSLATION: Record<SubjectKey, string> = {
  kammi: "subjectKammi",
  lafthi: "subjectLafthi",
  esl: "subjectEsl",
  ministry: "subjectMinistry",
  future: "subjectFuture",
  t_math: "subjectTMath",
  t_chem: "subjectTChem",
  t_bio: "subjectTBio",
  t_physics: "subjectTPhysics",
};

const DAY_LABELS: Record<Lang, Record<Day, string>> = {
  en: { Sun: "Sun", Mon: "Mon", Tue: "Tue", Wed: "Wed", Thu: "Thu" },
  ar: { Sun: "الأحد", Mon: "الاثنين", Tue: "الثلاثاء", Wed: "الأربعاء", Thu: "الخميس" },
};

const SEGMENT_LABELS: Record<Lang, Record<string, string>> = {
  en: { Ufuq: "Ufuq", Tracks: "Tracks" },
  ar: { Ufuq: "أفق", Tracks: "تراكس" },
};

const NAME_PARTS_AR: Record<string, string> = {
  Abdullah: "عبدالله",
  Faisal: "فيصل",
  Omar: "عمر",
  Khalid: "خالد",
  Tariq: "طارق",
  Zaid: "زيد",
  Hamad: "حمد",
  Nasser: "ناصر",
  Sultan: "سلطان",
  Badr: "بدر",
  Saud: "سعود",
  Majed: "ماجد",
  Yazeed: "يزيد",
  Turki: "تركي",
  Rayan: "ريان",
  Talal: "طلال",
  Ziyad: "زياد",
  Ali: "علي",
  Saleh: "صالح",
  Mishaal: "مشعل",
  Fahad: "فهد",
  Hamdan: "حمدان",
  Yahya: "يحيى",
  "Al-Qahtani": "القحطاني",
  "Al-Dosari": "الدوسري",
  "Al-Shehri": "الشهري",
  "Al-Ghamdi": "الغامدي",
  "Al-Harbi": "الحربي",
  "Al-Otaibi": "العتيبي",
  "Al-Zahrani": "الزهراني",
  "Al-Malki": "المالكي",
  "Al-Anazi": "العنزي",
  "Al-Rashid": "الرشيد",
  "Al-Shammari": "الشمري",
  "Al-Sabah": "الصباح",
  "Al-Farhan": "الفرحان",
  "Al-Hazmi": "الحازمي",
  "Al-Amri": "العمري",
  "Al-Mutairi": "المطيري",
  "Al-Jasser": "الجاسر",
  "Al-Salem": "السالم",
  "Al-Harthi": "الحارثي",
  "Al-Fayez": "الفايز",
};

export function getT(lang: Lang) {
  return I18N[lang];
}

export function getDayLabel(lang: Lang, day: Day) {
  return DAY_LABELS[lang][day] || day;
}

export function formatDayPattern(lang: Lang, pattern: string) {
  return pattern
    .split("/")
    .map((day) => DAY_LABELS[lang][day as Day] || day)
    .join(" / ");
}

export function getSubjectLabelFromT(t: Translations, subject: SubjectKey) {
  return t[SUBJECT_KEY_TO_TRANSLATION[subject]] || subject;
}

export function localizeRoomName(lang: Lang, roomName: string) {
  if (lang !== "ar") return roomName;
  return roomName.replace(/^Room\s+/i, "فصل ");
}

export function localizePersonName(lang: Lang, name: string) {
  if (lang !== "ar") return name;
  return name
    .split(" ")
    .map((token) => NAME_PARTS_AR[token] || token)
    .join(" ");
}

export function localizeSegment(lang: Lang, segment: string | null) {
  if (!segment) return "";
  return SEGMENT_LABELS[lang][segment] || segment;
}
